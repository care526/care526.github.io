(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{563:function(t,n,a){"use strict";a.r(n);var s=a(32),e=Object(s.a)({},(function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"插件编写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件编写"}},[t._v("#")]),t._v(" 插件编写")]),t._v(" "),a("h2",{attrs:{id:"组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组成"}},[t._v("#")]),t._v(" 组成")]),t._v(" "),a("ol",[a("li",[t._v("一个 JavaScript 命名函数")]),t._v(" "),a("li",[t._v("在插件函数的 prototype 上定义一个 apply 方法。")]),t._v(" "),a("li",[t._v("指定一个绑定到 webpack 自身的事件钩子。")]),t._v(" "),a("li",[t._v("处理 webpack 内部实例的特定数据。")]),t._v(" "),a("li",[t._v("功能完成后调用 webpack 提供的回调。")])]),t._v(" "),a("h2",{attrs:{id:"代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一个 JavaScript 命名函数。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("MyExampleWebpackPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在插件函数的 prototype 上定义一个 `apply` 方法。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyExampleWebpackPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("apply")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("compiler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定一个挂载到 webpack 自身的事件钩子。")]),t._v("\n  compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpacksEventHook'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("compilation "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 处理 webpack 内部实例的特定数据。*/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This is an example plugin!!!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 功能完成后调用 webpack 提供的回调。")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"compiler钩子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compiler钩子"}},[t._v("#")]),t._v(" compiler钩子")]),t._v(" "),a("ul",[a("li",[t._v("entryOption\n在 entry 配置项处理过之后，执行插件")]),t._v(" "),a("li",[t._v("afterPlugins\n设置完初始插件之后，执行插件")]),t._v(" "),a("li",[t._v("afterResolvers\nresolver 安装完成之后，执行插件")]),t._v(" "),a("li",[t._v("environment\nenvironment 准备好之后，执行插件")]),t._v(" "),a("li",[t._v("afterEnvironment\nenvironment 安装完成之后，执行插件")]),t._v(" "),a("li",[t._v("beforeRun\ncompiler.run() 执行之前，添加一个钩子")]),t._v(" "),a("li",[t._v("run\n开始读取 records 之前，钩入(hook into) compiler")]),t._v(" "),a("li",[t._v("watchRun\n监听模式下，一个新的编译(compilation)触发之后，执行一个插件，但是是在实际编译开始之前")]),t._v(" "),a("li",[t._v("normalModuleFactory\nNormalModuleFactory 创建之后，执行插件")]),t._v(" "),a("li",[t._v("contextModuleFactory\nContextModuleFactory 创建之后，执行插件")]),t._v(" "),a("li",[t._v("beforeCompile\n编译(compilation)参数创建之后，执行插件")]),t._v(" "),a("li",[t._v("compile\n一个新的编译(compilation)创建之后，钩入(hook into) compiler")]),t._v(" "),a("li",[t._v("thisCompilation\n触发 compilation 事件之前执行")]),t._v(" "),a("li",[t._v("compilation\n编译(compilation)创建之后，执行插件")]),t._v(" "),a("li",[t._v("make")]),t._v(" "),a("li",[t._v("afterCompile")]),t._v(" "),a("li",[t._v("shouldEmit")]),t._v(" "),a("li",[t._v("needAdditionalPass")]),t._v(" "),a("li",[t._v("emit\n生成资源到 output 目录之前")]),t._v(" "),a("li",[t._v("afterEmit\n生成资源到 output 目录之后")]),t._v(" "),a("li",[t._v("done\n编译(compilation)完成")]),t._v(" "),a("li",[t._v("failed\n编译(compilation)失败")]),t._v(" "),a("li",[t._v("invalid\n监听模式下，编译无效时")]),t._v(" "),a("li",[t._v("watchClose\n监听模式停止")])])])}),[],!1,null,null,null);n.default=e.exports}}]);